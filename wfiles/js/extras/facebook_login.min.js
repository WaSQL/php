function facebookStatusChangeCallback(e,o){var t='<img src="/wfiles/iconsets/16/facebook.png" border="0" />';if("connected"===e.status)FB.api("/me",function(e){if(void 0!=o){if(void 0!=document.loginform)return document.loginform.username.value=e.email,document.loginform.username.name="facebook_email",document.loginform.password.value=e.id,void document.loginform.submit();void 0!=document.registerform&&(void 0!=document.registerform.username&&(document.registerform.username.value=e.email),void 0!=document.registerform.email&&(document.registerform.email.value=e.email));var a=document.createElement("input");a.nme="facebook_email",a.value=e.email,document.registerform.appendChild(a),a=document.createElement("input"),a.name="facebook_id",a.value=e.id,document.registerform.appendChild(a),document.registerform.submit()}var n="";if(void 0!=facebook_email&&void 0!=facebook_id){var i=window.btoa(e.id+":"+e.email);n=0==facebook_email.length&&0==facebook_id.length?'<a href="#" title="Link this account to the '+e.email+' facebook account" onclick="return facebookLink(\''+i+'\');" class="w_dblue w_link">'+t+" Link</a>":facebook_email!=e.email||facebook_id!=e.id?'<a href="#" title="Update this account to the '+e.email+' facebook account" onclick="return facebookUpdateLink(\''+i+'\');" class="w_dblue w_link">'+t+" Update Link</a>":'<span class="w_dblue w_link" title="Linked to the '+e.email+' facebook account.">'+t+" Linked</span>"}setText("facebook_status",n)});else if("not_authorized"===e.status){var a='<fb:login-button size="small" scope="public_profile,email" onlogin="facebookCheckLoginState();">Link Accounts</fb:login-button>';setText("facebook_status",a),facebookInit()}else if(facebook_email.length&&facebook_id.length)a='<span class="w_dblue w_link" title="Linked to the '+facebook_email+' facebook account.">'+t+" Linked</span>",setText("facebook_status",a);else{var a='<fb:login-button size="small" scope="public_profile,email" onlogin="facebookCheckLoginState();">Link Accounts</fb:login-button>';setText("facebook_status",a),facebookInit()}}function facebookLinked(){var e='<img src="/wfiles/iconsets/16/facebook.png" border="0" />';facebook_status='<span class="w_dblue w_link">'+e+" Linked</span>",setText("facebook_status",facebook_status)}function facebookCheckLoginState(e){FB.getLoginStatus(function(o){facebookStatusChangeCallback(o,e)})}function facebookLink(e){return ajaxGet(window.location.pathname,"facebook_status",{_template:1,_fblink:e})}function facebookUpdateLink(e){return ajaxGet(window.location.pathname,"facebook_status",{_template:1,_fbupdate:e})}function facebookInit(){FB.init({appId:facebook_appid,cookie:!0,xfbml:!0,version:"v2.0"})}!function(e,o,t){var a,n=e.getElementsByTagName(o)[0];e.getElementById(t)||(a=e.createElement(o),a.id=t,a.src="//connect.facebook.net/en_US/sdk.js",n.parentNode.insertBefore(a,n))}(document,"script","facebook-jssdk"),window.fbAsyncInit=function(){facebookInit(),FB.getLoginStatus(function(e){facebookStatusChangeCallback(e)})};