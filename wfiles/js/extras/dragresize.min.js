function cancelEvent(e,n){e.returnValue=!1,e.preventDefault&&e.preventDefault(),n&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}function DragResize(e,n){var t={myName:e,enabled:!0,handles:["tl","tm","tr","ml","mr","bl","bm","br"],isElement:null,isHandle:null,element:null,handle:null,minWidth:10,minHeight:10,minLeft:0,maxLeft:9999,minTop:0,maxTop:9999,zIndex:1,mouseX:0,mouseY:0,lastMouseX:0,lastMouseY:0,mOffX:0,mOffY:0,elmX:0,elmY:0,elmW:0,elmH:0,allowBlur:!0,ondragfocus:null,ondragstart:null,ondragmove:null,ondragend:null,ondragblur:null};for(var l in t)this[l]="undefined"==typeof n[l]?t[l]:n[l]}if("function"!=typeof addEvent){var addEvent=function(e,n,t,l){var m="addEventListener",d="on"+n,i=e,a=n,s=t,f=l;return e[m]&&!l?e[m](n,t,!1):(e._evts||(e._evts={}),e._evts[n]||(e._evts[n]=e[d]?{b:e[d]}:{},e[d]=new Function("e",'var r = true, o = this, a = o._evts["'+n+'"], i; for (i in a) {o._f = a[i]; r = o._f(e||window.event) != false && r; o._f = null;} return r'),"unload"!=n&&addEvent(window,"unload",function(){removeEvent(i,a,s,f)})),t._i||(t._i=addEvent._i++),void(e._evts[n][t._i]=t))};addEvent._i=1;var removeEvent=function(e,n,t,l){var m="removeEventListener";return e[m]&&!l?e[m](n,t,!1):void(e._evts&&e._evts[n]&&t._i&&delete e._evts[n][t._i])}}DragResize.prototype.apply=function(e){var n=this;addEvent(e,"mousedown",function(e){n.mouseDown(e)}),addEvent(e,"mousemove",function(e){n.mouseMove(e)}),addEvent(e,"mouseup",function(e){n.mouseUp(e)})},DragResize.prototype.select=function(newElement){with(this){if(!document.getElementById||!enabled)return;newElement&&newElement!=element&&enabled&&(element=newElement,element.style.zIndex=++zIndex,this.resizeHandleSet&&this.resizeHandleSet(element,!0),elmX=parseInt(element.style.left),elmY=parseInt(element.style.top),elmW=element.offsetWidth,elmH=element.offsetHeight,ondragfocus&&this.ondragfocus())}},DragResize.prototype.deselect=function(delHandles){with(this){if(!document.getElementById||!enabled)return;delHandles&&(ondragblur&&this.ondragblur(),this.resizeHandleSet&&this.resizeHandleSet(element,!1),element=null),handle=null,mOffX=0,mOffY=0}},DragResize.prototype.mouseDown=function(e){with(this){if(!document.getElementById||!enabled)return!0;for(var elm=e.target||e.srcElement,newElement=null,newHandle=null,hRE=new RegExp(myName+"-([trmbl]{2})","");elm;){if(elm.className&&(newHandle||!hRE.test(elm.className)&&!isHandle(elm)||(newHandle=elm),isElement(elm))){newElement=elm;break}elm=elm.parentNode}element&&element!=newElement&&allowBlur&&deselect(!0),!newElement||element&&newElement!=element||(newHandle&&cancelEvent(e),select(newElement,newHandle),handle=newHandle,handle&&ondragstart&&this.ondragstart(hRE.test(handle.className)))}},DragResize.prototype.mouseMove=function(e){with(this){if(!document.getElementById||!enabled)return!0;mouseX=e.pageX||e.clientX+document.documentElement.scrollLeft,mouseY=e.pageY||e.clientY+document.documentElement.scrollTop;var diffX=mouseX-lastMouseX+mOffX,diffY=mouseY-lastMouseY+mOffY;if(mOffX=mOffY=0,lastMouseX=mouseX,lastMouseY=mouseY,!handle)return!0;var isResize=!1;if(this.resizeHandleDrag&&this.resizeHandleDrag(diffX,diffY))isResize=!0;else{var dX=diffX,dY=diffY;elmX+dX<minLeft?mOffX=dX-(diffX=minLeft-elmX):elmX+elmW+dX>maxLeft&&(mOffX=dX-(diffX=maxLeft-elmX-elmW)),elmY+dY<minTop?mOffY=dY-(diffY=minTop-elmY):elmY+elmH+dY>maxTop&&(mOffY=dY-(diffY=maxTop-elmY-elmH)),elmX+=diffX,elmY+=diffY}with(element.style)left=elmX+"px",width=elmW+"px",top=elmY+"px",height=elmH+"px";if(window.opera&&document.documentElement){var oDF=document.getElementById("op-drag-fix");if(!oDF){var oDF=document.createElement("input");oDF.id="op-drag-fix",oDF.style.display="none",document.body.appendChild(oDF)}oDF.focus()}ondragmove&&this.ondragmove(isResize),cancelEvent(e)}},DragResize.prototype.mouseUp=function(e){with(this){if(!document.getElementById||!enabled)return;var hRE=new RegExp(myName+"-([trmbl]{2})","");handle&&ondragend&&this.ondragend(hRE.test(handle.className)),deselect(!1)}},DragResize.prototype.resizeHandleSet=function(elm,show){with(this){if(!elm._handle_tr)for(var h=0;h<handles.length;h++){var hDiv=document.createElement("div");hDiv.className=myName+" "+myName+"-"+handles[h],elm["_handle_"+handles[h]]=elm.appendChild(hDiv)}for(var h=0;h<handles.length;h++)elm["_handle_"+handles[h]].style.visibility=show?"inherit":"hidden"}},DragResize.prototype.resizeHandleDrag=function(diffX,diffY){with(this){var hClass=handle&&handle.className&&handle.className.match(new RegExp(myName+"-([tmblr]{2})"))?RegExp.$1:"",dY=diffY,dX=diffX,processed=!1;return hClass.indexOf("t")>=0&&(rs=1,elmH-dY<minHeight?mOffY=dY-(diffY=elmH-minHeight):elmY+dY<minTop&&(mOffY=dY-(diffY=minTop-elmY)),elmY+=diffY,elmH-=diffY,processed=!0),hClass.indexOf("b")>=0&&(rs=1,elmH+dY<minHeight?mOffY=dY-(diffY=minHeight-elmH):elmY+elmH+dY>maxTop&&(mOffY=dY-(diffY=maxTop-elmY-elmH)),elmH+=diffY,processed=!0),hClass.indexOf("l")>=0&&(rs=1,elmW-dX<minWidth?mOffX=dX-(diffX=elmW-minWidth):elmX+dX<minLeft&&(mOffX=dX-(diffX=minLeft-elmX)),elmX+=diffX,elmW-=diffX,processed=!0),hClass.indexOf("r")>=0&&(rs=1,elmW+dX<minWidth?mOffX=dX-(diffX=minWidth-elmW):elmX+elmW+dX>maxLeft&&(mOffX=dX-(diffX=maxLeft-elmX-elmW)),elmW+=diffX,processed=!0),processed}};