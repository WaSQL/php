function marquee(t){if(mobj=getObject(t),void 0==mobj)return!1;mobj.id;clearTimeout(TimoutArray[t]);var e=getAllAttributes(mobj);if(void 0==e.m&&(mobj.setAttribute("m",0),e.m=0),"undefined"!=typeof mobj.onmouseover&&(mobj.onmouseover=function(){this.setAttribute("m",1)},mobj.onmouseout=function(t){void 0==t&&(t=fixE(t)),void 0!=t&&checkMouseLeave(this,t)&&this.setAttribute("m",0)}),void 0==e.m||0==e.m){var o=getTextPixelWidthHeight(mobj),i=getWidthHeight(mobj),r=20;void 0!=e.timer&&(speed=e.timer);var a="left";switch(void 0!=e.direction&&(a=e.direction),a.toLowerCase()){case"left":mobj.style.textAlign="right",mobj.style.whiteSpace="nowrap",mobj.style.paddingLeft="0px",void 0!=mobj.style.paddingRight&&(x=mobj.style.paddingRight,x.length?(x=x.replace("px",""),x=parseInt(x)):x=0),mobj.style.paddingRight=x<i[0]-o[0]-2?parseInt(x+2)+"px":"0px";break;case"right":mobj.style.textAlign="left",mobj.style.whiteSpace="nowrap",mobj.style.paddingRight="0px",void 0!=mobj.style.paddingLeft&&(x=mobj.style.paddingLeft,x.length?(x=x.replace("px",""),x=parseInt(x)):x=0),mobj.style.paddingLeft=x<i[0]-o[0]-2?parseInt(x+2)+"px":"0px";break;default:return!1}}TimoutArray[t]=setTimeout("marquee('"+t+"')",r)}function mouseMove(t){if(!t)var t=window.event;t.pageX||t.pageY?(cursor.x=t.pageX,cursor.y=t.pageY):(t.clientX||t.clientY)&&document.body&&document.documentElement&&(cursor.x=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,cursor.y=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),MouseY=cursor.y,MouseX=cursor.x}function mp3Player(t,e,o){void 0==o&&(o=0);var i="";i+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" width="165" height="38" id="niftyPlayer1" align="">\n',i+='<param name=movie value="/wfiles/niftyplayer.swf?file='+t+"&as="+o+'">\n',i+="<param name=quality value=high>\n",i+="<param name=bgcolor value=#FFFFFF>\n",i+='<embed src="/wfiles/niftyplayer.swf?file='+t+"&as="+o+'" quality=high bgcolor=#FFFFFF width="165" height="38" name="niftyPlayer1" align="" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">\n',i+="</embed>\n",i+="</object>\n",setText(e,i)}function embedFlash(t,e){void 0==e.width&&(e.width=400),void 0==e.height&&(e.height=300),void 0==e.bgcolor&&(e.bgcolor="#FFFFFF"),void 0==e.name&&(e.name="flashobj");var o="";o+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" width="'+e.width+'" height="'+e.height+'" id="'+e.name+'" align="">\n',o+='<param name=movie value="'+t+'">\n',o+='<param name="quality" value="high">\n',o+='<param name="wmode" value="transparent">\n',o+='<param name="bgcolor" value="'+e.bgcolor+'">\n',o+='<embed src="'+t+'" wmode="transparent" quality="high" bgcolor="'+e.bgcolor+'" width="'+e.width+'" height="'+e.height+'" name="'+e.name+'" align="" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">\n',o+="</embed>\n",o+="</object>\n",void 0!=e.debug&&alert(o),void 0!=e.popup&&1==e.popup?popUpDiv(o,e):setText(e.id,o)}function makeDivFloat(t,e,o){setFloatDiv(t,e,o).floatIt()}function setFloatDiv(t,e,o){var i=d.getElementById?d.getElementById(t):d.all?d.all[t]:d.layers[t],r=document.layers?"":"px";return window[t+"_obj"]=i,d.layers&&(i.style=i),i.cx=i.sx=e,i.cy=i.sy=o,i.sP=function(t,e){this.style.left=t+r,this.style.top=e+r},i.floatIt=function(){var t,e;t=this.sx>=0?0:ns?innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body.clientWidth,e=ns?pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop,this.sy<0&&(e+=ns?innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight),this.cx+=(t+this.sx-this.cx)/8,this.cy+=(e+this.sy-this.cy)/8,this.sP(this.cx,this.cy),setTimeout(this.id+"_obj.floatIt()",40)},i}function schedulePageRefresh(t,e,o,i){var r="schedulePageRefresh";clearTimeout(TimoutArray[r]),void 0==i&&(i=6e4),TimoutArray[r]=setTimeout('pageRefresh("'+t+'","'+e+'","'+o+'")',i)}function scheduleAjaxGet(t,e,o,i,r,a){clearTimeout(TimoutArray[t]),void 0==r&&(r=6e4),void 0==a&&(a=0),TimoutArray[t]=setTimeout('pageRefresh("'+e+'","'+o+'","'+i+'",'+a+")",r)}function pageRefresh(t,e,o,i){return void 0==document.getElementById(e)?!1:void ajaxGet("/"+t,e,o,"",6e4,i)}function processMultiComboBox(t,e,o,i,r){var a=document.getElementById(t),n=document.getElementById(e);i&&n&&(n.checked=n.checked?!1:!0);for(var s=GetElementsByAttribute("input","name",t),d=0,l="",u=0;u<s.length;u++)s[u].checked&&(r&&(l+=s[u].value+","),d++);a.value=r?l:d+"/"+o+" selected"}function setChangeState(t){var e=document.getElementById(t);changeState[t]=e.value}function setChangeValue(t,e){changeValue[t]=e}function evalChange(tid){eval(changeValue[tid])}function hasChanged(t){var e=document.getElementById(t),o=0,i=e.value,r=changeState[t];return i!=r&&o++,o?!0:!1}function iframePopup(t,e){void 0==e&&(e=new Object);var o="";return void 0==e.iwidth&&(e.iwidth=500),void 0==e.iheight&&(e.iheight=300),void 0==e.iscrolling&&(e.iscrolling="auto"),o+='<div class="w_centerpop_title">'+e.title+"</div>\n",o+='<div class="w_centerpop_content">\n',o+='<iframe seamless="1" src="'+t+'" width="'+e.iwidth+'" height="'+e.iheight+'" frameborder="0" marginwidth="0" marginheight="0" scrolling="'+e.iscrolling+'" align="center">Your browser does not support iframes.</iframe>',o+="</div>\n",centerpopDiv(o,null,0),!1}function w_shareButton(t){return window.open(t,"_blank","scrollbars=no, location=no, width=600, height=400, status=no, toolbar=no, menubar=no",!1),!1}function ajaxPopup(t,e,o){var i="ajaxPopupDiv",r={id:i,drag:1};if(o){for(var a in r)void 0!=o[a]&&(r[a]=o[a]);for(var a in o)void 0==r[a]&&(r[a]=o[a])}popUpDiv('<div class="w_bold w_lblue w_big"><img src="/wfiles/loading_blu.gif" border="0"> loading...please wait.</div>',r),ajaxGet(t,r.id+"_Body",e)}function centerpopDiv(t,e,o){void 0==o&&(o="");var i="centerpop"+o;void 0!=document.getElementById(t)&&(t=getText(t));var r={id:i,drag:1,notop:1,nobot:1,noborder:1,nobackground:1,bodystyle:"padding:0px;border:0px;background:none;"};return void 0!=e&&e>0&&(r.showtime=e),popUpDiv("",r),setCenterPopText(i,t,{drag:!1,close_bot:!1}),centerObject(i),!1}function tooltipDiv(t){t=getObject(t);var e=t.getAttribute("data-tooltip"),o=t.getAttribute("data-tooltip_position")||"";if(0==e.indexOf("id:")){var i=str_replace("id:","",e);e=getText(i)||""}else if(0==e.indexOf("att:")){var r=str_replace("att:","",e);e=t.getAttribute(r)||""}if(0==e.length)return!1;var a=getObject("w_tooltip");void 0!=a&&removeId(a);var n=document.createElement("div");n.setAttribute("id","w_tooltip"),n.style.zIndex="698999",n.style.position="absolute",n.innerHTML=e;var s=findPos(t),d=y=h=w=th=0;return h=getHeight(t),""==o&&"img"==t.nodeName.toLowerCase()&&(o="bottom"),"bottom"==o?(h=getHeight(t),w=getWidth(t),y=s.y+h+6,d=s.x):(n.setAttribute("class","left"),w=getWidth(t),y=s.y,d=s.x+w+6),n.style.top=y+"px",n.style.left=d+"px",document.body.appendChild(n),!1}function popUpDiv(t,e){var o="position:absolute;top:200px;left:200px;margin:5px;z-index:999;",i="padding:5px;border:1px solid #d6dee7;background:#FFF;";clearTimeout("popupdiv_timeout"),void 0!=e.width&&(o+="width:"+e.width+"px;"),void 0!=e.height&&(i+="height:"+e.height+"px;overflow:auto;");var r={id:"w"+(new Date).getTime(),style:o,title:"",closestyle:"cursor:pointer;",close:'<img src="/wfiles/x_red.gif" border="0">',bodystyle:i,titleleft:20,body:t};if(e){for(var a in r)void 0!=e[a]&&(r[a]=e[a]);for(var a in e)void 0==r[a]&&(r[a]=e[a])}var n;if(void 0!=document.getElementById(r.id)&&removeDiv(r.id),void 0!=document.getElementById(r.id)){n=document.getElementById(r.id);var s=r.id+"_Body";n.style.display="block",void 0!=document.getElementById(s)&&setText(s,r.body)}else{n=document.createElement("div"),n.setAttribute("id",r.id),n.style.zIndex="698",n.style.position="absolute";var d=document.createElement("table");d.border=0,d.align="left",d.cellPadding=0,d.cellSpacing=0,void 0!=r.width&&(d.style.width=r.width+"px");var l="#49495a";r.titlebgcolor?l=r.titlebgcolor:e.titlebgcolor&&(l=e.titlebgcolor),d.style.border=void 0==e.noborder?"1px solid "+l:"0px solid "+l;var u=document.createElement("tbody");if(void 0==e.notop){var c=document.createElement("tr"),v=document.createElement("td");v.noWrap=!0,v.align="right",v.style.fontFamily="arial",v.style.fontSize="11px",v.style.backgroundColor=l,v.style.color=r.titlecolor?r.titlecolor:"#FFFFFF";var h=document.createElement("div"),m='<div id="'+r.id+'_Title" style="float:left;margin-left:10px;margin-top:1px">'+r.title+"</div>";m+='<a href="#" style="font-weight:bold;font-size:12px;font-family:arial;color:#970000;text-decoration:none;padding:0 3px 0 0;" onClick="fadeId(\''+r.id+"',1);return false;\">X</a>",h.innerHTML=m,v.appendChild(h),c.appendChild(v),u.appendChild(c)}var g=document.createElement("tr");g.height="100%";var p=document.createElement("td");void 0==e.nobackground&&(p.style.backgroundColor="#FFFFFF");var b=document.createElement("div"),f='<div id="'+r.id+'_Body">'+r.body;if(f+="</div>",b.innerHTML=f,p.appendChild(b),g.appendChild(p),u.appendChild(g),void 0==e.nobot){var y=document.createElement("tr"),x=document.createElement("td");x.noWrap=!0,x.align="right",x.style.fontFamily="arial",x.style.fontSize="11px";var l="#FFFFFF";r.botbgcolor?l=r.botbgcolor:e.botbgcolor&&(l=e.botbgcolor),x.style.backgroundColor=l;var E=document.createElement("div"),w='<a href="#" class="w_red w_bold w_link"" onClick="fadeId(\''+r.id+"',1);return false;\">Close</a>";E.innerHTML=w,x.appendChild(E),y.appendChild(x),u.appendChild(y)}d.appendChild(u),n.style.display="block",n.appendChild(d),r.drag&&void 0==e.notop&&(Drag.init(h,n),h.style.cursor="move"),document.body.appendChild(n)}if(n.style.display="block",r.center){var A=centerObject(n),_=0,M=0,j=r.center+"";-1!=j.indexOf("x")?_=A[0]:-1!=j.indexOf("y")?M=A[1]:(_=A[0],M=A[1]),void 0!=r.x&&(xvalue=r.x+"",_=Math.round(-1!=xvalue.indexOf("+")?MouseX+parseInt(xvalue):-1!=xvalue.indexOf("-")?MouseX-Math.abs(parseInt(xvalue)):r.x),0>_&&(_=0)),void 0!=r.y&&(yvalue=r.y+"",M=Math.round(-1!=yvalue.indexOf("+")?MouseY+parseInt(yvalue):-1!=yvalue.indexOf("-")?MouseY-Math.abs(parseInt(yvalue)):r.y),0>M&&(M=0)),0>_&&(_=0),0>M&&(M=0),n.style.position="absolute",n.style.left=_+"px",n.style.top=M+"px"}else if(e.topright)n.style.position="absolute",n.style.top=e.topright+"px",n.style.right=e.topright+"px";else if(e.topleft)n.style.position="absolute",n.style.top=e.topleft+"px",n.style.left=e.topleft+"px";else if(e.botright)n.style.position="absolute",n.style.bottom=e.botright+"px",n.style.right=e.botright+"px";else if(e.botleft)n.style.position="absolute",n.style.bottom=e.botleft+"px",n.style.left=e.botleft+"px";else if(r.screen)showOnScreen(n);else if(r.mouse){var _=0,M=0,j=r.mouse+"";-1!=j.indexOf("x")?_=MouseX:-1!=j.indexOf("y")&&(M=MouseY),void 0!=r.x&&(xvalue=r.x+"",_=-1!=xvalue.indexOf("+")?Math.round(MouseX+parseInt(xvalue)):-1!=xvalue.indexOf("-")?Math.round(MouseX-Math.abs(parseInt(xvalue))):MouseX),void 0!=r.y&&(yvalue=r.y+"",M=-1!=yvalue.indexOf("+")?Math.round(MouseY+parseInt(yvalue)):-1!=yvalue.indexOf("-")?Math.round(MouseY-Math.abs(parseInt(yvalue))):MouseY),0>_&&(_=0),0>M&&(M=0),n.style.top=M+"px",n.style.left=_+"px"}else void 0!=r.x&&(n.style.left=r.x+"px"),void 0!=r.y&&(n.style.top=r.y+"px");if(r.showtime){var d=Math.round(1e3*r.showtime);popupdiv_timeout=setTimeout("removeDivOnExit('"+r.id+"',1)",d)}else r.fade&&(n.onmouseout=function(t){void 0==t&&(t=fixE(t)),void 0!=t&&checkMouseLeave(this,t)&&fadeId(this.id,1)})}function createTable(){var t=document.createElement("table");tb=document.createElement("tbody"),t.setAttribute("border","1");var e,o,i=document.createElement("tr");o=document.createElement("div"),o.style.backgroundColor="red",o.style.minHeight="20px",o.style.width="50px",e=document.createElement("td"),e.appendChild(o),i.appendChild(e),o=document.createElement("div"),o.style.backgroundColor="green",o.style.minHeight="20px",o.style.width="50px",e=document.createElement("td"),e.appendChild(o),i.appendChild(e),tb.appendChild(i),t.appendChild(tb),document.getElementById("ajaxstatus").appendChild(t)}function removeDiv(t){return removeId(t)}function removeId(t){var e=getObject(t);void 0!=e&&(setText(t,""),isIE?e.removeNode(!0):e.parentNode.removeChild(e))}function removeDivOnExit(t,e){var o=getObject(t);if(void 0!=o)return isMouseOver(t)?void(o.onmouseout=void 0!=e&&1==e?function(t){void 0==t&&(t=fixE(t)),void 0!=t&&checkMouseLeave(this,t)&&fadeId(this.id,1)}:function(t){void 0==t&&(t=fixE(t)),void 0!=t&&checkMouseLeave(this,t)&&removeDiv(this.id)}):void(void 0!=e&&1==e?fadeId(t,1):removeDiv(t))}function isMouseOver(t){var e=getXY(t);if(void 0==e)return!0;var o=getWidthHeight(t);return MouseX>=e[0]&&MouseX<=e[0]+o[0]&&MouseY>=e[1]&&MouseY<=e[1]+o[1]?!0:!1}function getChildById(t,e){if(t.id==e)return t;if(t.hasChildNodes())for(var o=0;o<t.childNodes.length;o++){var i=getChildById(t.childNodes[o],e);if(null!=i)return i}return null}function centerObject(t,e){void 0==e&&(e=0);var o=getObject(t);if(void 0==o)return!1;var i=getWidth(o),r=getHeight(o);window.status=t+":"+i+","+r;var a=getViewportWidth(),n=getViewportHeight(),s=getScrollWidth(),d=getScrollHeight(),l=Math.round(a/2-i/2)+s,u=Math.round(n/2-r/2)+d;return o.style.position="absolute",o.style.left=l+"px",void 0==u&&(u=10),10>u&&(u=10),o.style.top=u+"px",1==e&&(o.onmouseout=function(t){void 0==t&&(t=fixE(t)),void 0!=t&&checkMouseLeave(this,t)&&fadeId(this.id,1)}),new Array(l,u)}function hideOnExit(t){var e=getObject(t);return void 0==e?!1:void(e.onmouseout=function(t){void 0==t&&(t=fixE(t)),void 0!=t&&checkMouseLeave(this,t)&&(this.style.display="none")})}function showOnScreen(t){var e=getObject(t);if(void 0==e)return!1;e.style.position="absolute",e.style.visibility="hidden",e.style.display="block";var o=getWidth(e),i=getHeight(e),r=(getViewPort(),getWidth()),a=getHeight(),n=cursor.x,s=cursor.y;if(n+o+20>r){for(var d=n-o;0>d;)d++;n=d}if(s+i+20>a){for(var d=s-i;0>d;)d++;s=d}return e.style.left=n+"px",e.style.top=s+"px",e.style.visibility="visible",new Array(n,s)}function getViewPort(){var t={};return"undefined"!=typeof window.innerWidth?(t.w=window.innerWidth,t.h=window.innerHeight):"undefined"!=typeof document.documentElement&&"undefined"!=typeof document.documentElement.clientWidth&&0!=document.documentElement.clientWidth?(t.w=document.documentElement.clientWidth,t.h=document.documentElement.clientHeight):(t.w=document.getElementsByTagName("body")[0].clientWidth,t.h=document.getElementsByTagName("body")[0].clientHeight),t}function initBehaviors(ajaxdiv){try{f_tcalInit()}catch(e){}for(var tobs=GetElementsByAttribute("*","data-tooltip",".+"),i=0;i<tobs.length;i++)addEvent(tobs[i],"mouseover",function(){tooltipDiv(this)}),addEvent(tobs[i],"mouseout",function(){fadeId("w_tooltip",1)});for(var navEls=GetElementsByAttribute("*","data-behavior",".+"),navEls2=GetElementsByAttribute("*","_behavior",".+"),n=0;n<navEls2.length;n++)navEls2[n].setAttribute("data-behavior",navEls2[n].getAttribute("_behavior")),navEls2[n].removeAttribute("_behavior"),navEls[navEls.length]=navEls2[n];for(var n=0;n<navEls.length;n++){var str=navEls[n].getAttribute("data-behavior").toLowerCase(),behaviors=str.split(/[\ \;\,\:]+/);if(in_array("ajax",behaviors)){var attr=getAllAttributes(navEls[n]);void 0!=attr.id&&void 0!=attr.url&&void 0!=attr.timer&&ajaxTimer(attr.id)}else if(in_array("animate",behaviors))navEls[n].onmouseover=function(){animateGrow(this.id,parseInt(this.getAttribute("min")),parseInt(this.getAttribute("max")))},navEls[n].onmouseout=function(t){void 0==t&&(t=fixE(t)),void 0!=t&&checkMouseLeave(this,t)&&animateShrink(this.id,parseInt(this.getAttribute("max")),parseInt(this.getAttribute("min")))};else if(in_array("autogrow",behaviors))navEls[n].setAttribute("data-autogrow",navEls[n].style.height),navEls[n].onfocus=function(){autoGrow(this)},navEls[n].onkeypress=function(){autoGrow(this)},navEls[n].onblur=function(){var t=this.getAttribute("data-autogrow");this.style.height=t};else if(in_array("chart",behaviors)){var chart_type=navEls[n].getAttribute("data-type")||"bar";chart_type=chart_type.toLowerCase();var chart_labels=navEls[n].getAttribute("data-labels")||"";chart_labels=chart_labels.split(",");for(var chart_datasets=new Array,chart_id=navEls[n].getAttribute("data-datasets")||"",chart_ids=GetElementsByAttribute("div","id",chart_id),i=0;i<chart_ids.length;i++){var txt=getText(chart_ids[i]),dataset=parseJSONString(txt);chart_datasets.push(dataset)}var chart_data={labels:chart_labels,datasets:chart_datasets},chart_options=navEls[n].getAttribute("data-options")||"";void 0!=document.getElementById(chart_options)&&(chart_options=getText(chart_options));var chart_options=parseJSONString(chart_options);switch(chart_type){case"bar":var myLine=new Chart(navEls[n].getContext("2d")).Bar(chart_data,chart_options);break;case"line":var myLine=new Chart(navEls[n].getContext("2d")).Line(chart_data,chart_options);break;case"pie":var myLine=new Chart(navEls[n].getContext("2d")).Pie(chart_data,chart_options)}var chart_image=navEls[n].getAttribute("data-image")||"";if(chart_image.length){var img=navEls[n].toDataURL();setText(chart_image,img)}}else if(in_array("clock",behaviors)){var id=navEls[n].getAttribute("id");id&&startClock(id,1)}else if(in_array("countdown",behaviors)){var id=navEls[n].getAttribute("id");id&&countDown(id)}else if(in_array("countdowndate",behaviors)){var id=navEls[n].getAttribute("id");if(id){var yr=navEls[n].getAttribute("year"),mon=navEls[n].getAttribute("month"),day=navEls[n].getAttribute("day"),hr=navEls[n].getAttribute("hour"),m=navEls[n].getAttribute("minute"),t=navEls[n].getAttribute("tz");countDownDate(id,yr,mon,day,hr,m,t)}}else if(in_array("drag",behaviors)){var head=navEls[n].getAttribute("head"),headobj=getObject(head);navEls[n].style.position="relative",void 0==headobj?Drag.init(navEls[n]):Drag.init(headobj,navEls[n])}else if(in_array("signature",behaviors)){var pencolor=navEls[n].getAttribute("data-color")||"#000";signaturePad=new SignaturePad(navEls[n],{penColor:pencolor})}else if(in_array("csseditor",behaviors))codemirrorTextEditor(navEls[n],"text/css","csseditor");else if(in_array("txteditor",behaviors))codemirrorTextEditor(navEls[n],"text/plain","txteditor");else if(in_array("javascript",behaviors)||in_array("jseditor",behaviors))codemirrorTextEditor(navEls[n],"text/javascript","jseditor");else if(in_array("perleditor",behaviors))codemirrorTextEditor(navEls[n],"text/x-perl","perleditor");else if(in_array("phpeditor",behaviors))codemirrorTextEditor(navEls[n],"application/x-httpd-php","phpeditor");else if(in_array("rubyeditor",behaviors))codemirrorTextEditor(navEls[n],"text/x-ruby","rubyeditor");else if(in_array("sqleditor",behaviors))codemirrorTextEditor(navEls[n],"text/x-mysql","sqleditor");else if(in_array("vbscript",behaviors)||in_array("vbeditor",behaviors))codemirrorTextEditor(navEls[n],"text/vbscript","vbeditor");else if(in_array("richtext",behaviors)||in_array("wysiwyg",behaviors)||in_array("nicedit",behaviors)||in_array("tinymce",behaviors)){var id=navEls[n].getAttribute("id"),h=getHeight(navEls[n]),m=500;void 0!=h&&m>h&&(m=h),void 0!=nicEditors[id]&&nicEditors[id].removeInstance(id),nicEditors[id]=new nicEditor({fullPanel:!0,maxHeight:m}).panelInstance(id,{hasPanel:!0,maxHeight:m})}else if(in_array("xmleditor",behaviors))codemirrorTextEditor(navEls[n],{name:"xml",alignCDATA:!0},"xmleditor");else if(in_array("zoom",behaviors))void 0==navEls[n].getAttribute("id")&&navEls[n].setAttribute("id",guid()),void 0==navEls[n].getAttribute("data-zoomsrc")&&navEls[n].setAttribute("data-zoomsrc",navEls[n].src),MojoZoom.makeZoomable(navEls[n],navEls[n].getAttribute("data-zoomsrc"),document.getElementById(navEls[n].getAttribute("id")+"_zoom"),null,null,"true"==navEls[n].getAttribute("data-zoomalwaysshow"));else if(in_array("fileupload",behaviors))if(window.File&&window.FileReader&&window.FileList&&window.Blob){var path=navEls[n].getAttribute("path");navEls[n].addEventListener("dragenter",eventCancel,!1),navEls[n].addEventListener("dragexit",function(t){eventCancel(t);var e="";void 0!=this.getAttribute("_dragcolor_out")&&(e=this.getAttribute("_dragcolor_out")),this.style.backgroundColor=e},!1),navEls[n].addEventListener("dragover",function(t){eventCancel(t);var e="#ffff80";void 0!=this.getAttribute("_dragcolor_over")&&(e=this.getAttribute("_dragcolor_over")),this.style.backgroundColor=e},!1),navEls[n].addEventListener("drop",function(t){var e="";void 0!=this.getAttribute("_dragcolor_out")&&(e=this.getAttribute("_dragcolor_out")),this.style.backgroundColor=e,fileUploadBehavior(t,this)},!1)}else setText(navEls[n],"Fileupload via dragdrop is not supported in your browser.");else if(in_array("float",behaviors)){var id=navEls[n].getAttribute("id");if(id){var top=navEls[n].getAttribute("top");floatDiv(id,top)}}else if(in_array("pin",behaviors))navEls[n].onmouseout=function(e){if(void 0==e&&(e=fixE(e)),void 0!=e&&checkMouseLeave(this,e)){this.style.display="none";var onhide=this.getAttribute("onhide");onhide&&eval(onhide)}};else if(in_array("marquee",behaviors)){var attr=getAllAttributes(navEls[n]);void 0!=attr.id&&marquee(attr.id)}else if(in_array("menu",behaviors)){var dname=navEls[n].getAttribute("display");dname&&(navEls[n].onmouseover=function(){var t=this.getAttribute("display");if(dObj=getObject(t)){if("block"==dObj.style.display)return!0;dObj.style.display="block"}var e=this.getAttribute("mouse"),o=this.getAttribute("x"),i=this.getAttribute("y");if(void 0!=e){var r=0,a=0;-1!=e.indexOf("x")?r=MouseX:-1!=e.indexOf("y")?a=MouseY:(r=MouseX,a=MouseY),void 0!=o&&(xvalue=o+"",r=Math.round(-1!=xvalue.indexOf("+")?MouseX+parseInt(xvalue):-1!=xvalue.indexOf("-")?MouseX-Math.abs(parseInt(xvalue)):Math.abs(parseInt(xvalue)))),void 0!=i&&(yvalue=i+"",a=Math.round(-1!=yvalue.indexOf("+")?MouseY+parseInt(yvalue):-1!=yvalue.indexOf("-")?MouseY-Math.abs(parseInt(yvalue)):Math.abs(parseInt(yvalue)))),dObj.style.position="absolute",dObj.style.top=a+"px",dObj.style.left=r+"px"}},navEls[n].onmouseout=function(e){if(void 0==e&&(e=fixE(e)),void 0!=e&&checkMouseLeave(this,e)){var dname=this.getAttribute("display");if(dObj=getObject(dname)){var hide=0;if(void 0!=dObj.className)-1==dObj.className.indexOf("current")&&hide++;else{var cclass=dObj.getAttribute("class");void 0==cclass?hide++:-1==cclass.indexOf("current")&&hide++}hide&&(dObj.style.display="none")}var onhide=this.getAttribute("onhide");onhide&&eval(onhide)}})}else if(in_array("scrolltable",behaviors)){var id=navEls[n].getAttribute("id"),h=navEls[n].getAttribute("scrollheight"),w=navEls[n].getAttribute("scrollwidth");id&&scrollableTable(navEls[n],h,w)}else if(in_array("slideshow",behaviors)){var id=navEls[n].getAttribute("id");if(id){var t=navEls[n].getAttribute("timer");t?slideShow(id,0,t):slideShow(id,0)}}else if(in_array("sticky",behaviors)){var pos=getPos(navEls[n]),wh=getWidthHeight(navEls[n]);navEls[n].setAttribute("sticky_y",pos.y+wh[1]),navEls[n].setAttribute("sticky_x",pos.x+wh[0]),void 0!=navEls[n].style.zIndex&&navEls[n].setAttribute("sticky_z",navEls[n].style.zIndex),0==calledStickyMenus&&(addEvent(window,"scroll",stickyMenus),calledStickyMenus=1)}else if(in_array("stopwatch",behaviors)){var id=navEls[n].getAttribute("id");id&&stopWatch(id,0)}else if(in_array("time",behaviors)){var id=navEls[n].getAttribute("id");id&&startClock(id,0)}else for(b in behaviors){var behavior=behaviors[b],id=navEls[n].getAttribute("id"),re=new RegExp("^@([a-z]+)[(](.+)[)]$","igm"),res=re.exec(behavior);if(res&&res.length>0){var func=res[1].toLowerCase(),str=res[2].toLowerCase();switch(func){case"sum":for(var result=0,sids=str.split(/[,:\s]+/),s=0;s<sids.length;s++)result+=Math.round(getText(sids[s]));setText(navEls[n],result);break;case"math":doMath(id);break;case"raid":var cObj=getObject(str);"object"==typeof cObj&&(setText(cObj,getText(navEls[n])),navEls[n].setAttribute("raidid",str),navEls[n].onkeypress=function(){var t=this.getAttribute("raidid");setText(t,getText(this))},navEls[n].onblur=function(){var t=this.getAttribute("raidid");setText(t,getText(this))})}}}}}function stickyMenus(){for(var t=GetElementsByAttribute("*","data-behavior","sticky"),e=getWindowScrollPosition(),o=0;o<t.length;o++){var i=t[o].getAttribute("sticky_y");e>=i&&"fixed"!=t[o].style.position&&(t[o].style.position="fixed",t[o].style.top=0,t[o].style.width="100%",t[o].style.zIndex=99999,void 0!=t[o].id&&fadeIn(t[o].id)),i>e&&"relative"!=t[o].style.position&&(t[o].style.position="relative",t[o].style.top="",t[o].style.width="",t[o].style.zIndex=void 0!=t[o].getAttribute("sticky_z")?t[o].getAttribute("sticky_z"):"")}}function removeTinyMCE(t){tinyMCE.getInstanceById(t)&&tinyMCE.execCommand("mceRemoveControl",!1,t)}function addOnLoadEvent(t){addEvent(window,"load",t)}function addEvent(t,e,o){t.addEventListener?t.addEventListener(e,o,!1):t.attachEvent?t.attachEvent("on"+e,o):t[e]=o}function codemirrorTextEditor(t,e,o){if(t=getObject(t),void 0!=t.getAttribute("codeeditor_processed"))return!1;var i=!1;void 0!=t.getAttribute("readonly")&&(i=!0);var r={};void 0==t.getAttribute("data-nokeys")&&(r={F1:function(t){codemirrorHelp(t)},F5:function(t){var e=t.getTextArea(),o="centerpop";if(void 0!=e.getAttribute("ajaxid")?o=e.getAttribute("ajaxid"):void 0!=e.getAttribute("data-ajaxid")&&(o=e.getAttribute("data-ajaxid")),void 0!=e.getAttribute("preview")){t.save();var i=getElementForm(t.getWrapperElement());void 0!=i._action&&(i._action.value="EDIT"),void 0!=i._preview&&void 0!=i.name&&(i._preview.value=i.name.value),ajaxSubmitForm(i,o)}else ajaxGet("/php/index.php",o,"ajaxid="+o+"&_sqlpreview_="+t.getValue())},F6:function(t){var e=t.getOption("mode");switch(e){case"application/x-httpd-php":case"application/x-perl":t.replaceRange("$rtn .= '",t.getCursor(!0),t.getCursor(!1));break;case"application/x-ruby":t.replaceRange("rtn .= '",t.getCursor(!0),t.getCursor(!1));break;case"text/javascript":t.replaceRange("rtn += '",t.getCursor(!0),t.getCursor(!1))}},F7:function(t){var e=t.getOption("mode");switch(e){case"application/x-httpd-php":case"application/x-perl":case"application/x-ruby":t.replaceRange('\'."\\r\\n";',t.getCursor(!0),t.getCursor(!1));break;case"text/javascript":t.replaceRange('\'+"\\r\\n";',t.getCursor(!0),t.getCursor(!1))}},F11:function(t){var e=t.getScrollerElement(),o=t.getWrapperElement(),i=o.getAttribute("isfullscreen");void 0==i||1!=i?(o.setAttribute("isfullscreen",1),o.style.position="absolute",o.style.top=0,o.style.left=0,o.style.height="100%",o.style.width="100%",o.style.zIndex=99999,o.style.backgroundColor="#FFFFFF",e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.zIndex=99999,e.style.height="100%",e.style.width="100%",t.refresh()):(o.setAttribute("isfullscreen",0),o.style.position="relative",e.style.position="relative",o.style.zIndex=10,e.style.zIndex=10,e.style.height=o.getAttribute("setheight"),e.style.width=o.getAttribute("setwidth"),o.style.height=o.getAttribute("setheight"),o.style.width=o.getAttribute("setwidth"),t.refresh())},"Ctrl-Q":function(t){for(var e=t.lineCount(),o=0;e>o;o++)n(t,o)}});var a={mode:e,behavior:o,viewportMargin:"Infinity",indentUnit:4,indentWithTabs:!0,enterMode:"keep",tabMode:"shift",matchBrackets:!0,electricChars:!1,readOnly:i,textWrapping:!1,onBlur:function(t){t.save()},extraKeys:r};if(void 0==t.getAttribute("data-gutter")||"true"==t.getAttribute("data-gutter")){var n=CodeMirror.newFoldFunction(CodeMirror.braceRangeFinder);a.gutter=!0,a.fixedGutter=!0,a.onGutterClick=n,a.lineNumbers=!0}else a.gutter=!1,a.fixedGutter=!1,a.lineNumbers=!1;var s=CodeMirror.fromTextArea(t,a),d=s.getWrapperElement();t.setAttribute("codeeditor_processed",1),d.setAttribute("setheight",t.style.height),d.setAttribute("setwidth",t.style.width),d.style.width=t.style.width,d.style.height=t.style.height;var l=s.getScrollerElement();if(l.style.height=t.style.height,l.style.width=t.style.width,void 0!=t.getAttribute("focus")){s.focus();var u=t.getAttribute("focus").split(",",2);u[0]=u[0]-1,2==u.length?s.setCursor(u[0],u[1]):u>0&&s.setCursor(u[0])}}function codemirrorHelp(t){if(void 0!=document.getElementById("codemirrorpop"))return void removeDiv("codemirrorpop");var e=t.getTextArea(),o=e.getAttribute("data-behavior").toString().toUpperCase(),i="";if(i+='<div class="w_lblue w_bold w_big w_middle"><b style="color:red;">{ }</b> '+o+" Help</div>\n",i+="<div>Navigation Keys</div>\n",i+='<table cellspacing="0" cellpadding="2" border="1" class="w_table">\n',i+="  <tr><th>Function Keys</th><th>Description</th></tr>\n",i+="  <tr><td>F1</td><td>Help Screen Toggle</td></tr>\n",void 0!=e.getAttribute("preview")){var r=e.getAttribute("preview");i+=r.length>1?"  <tr><td>F5</td><td>"+r+"</td></tr>\n":void 0!=e.getAttribute("ajaxid")?"  <tr><td>F5</td><td>Preview</td></tr>\n":"  <tr><td>F5</td><td>Save and Preview Page</td></tr>\n"}else void 0!=e.getAttribute("data-ajaxid")&&(i+="  <tr><td>F5</td><td>Execute SQL</td></tr>\n");return i+="  <tr><td>F6</td><td>Begin $rtn string (mode sensitive)</td></tr>\n",i+="  <tr><td>F7</td><td>End $rtn string (mode sensitive)</td></tr>\n",i+="  <tr><td>F11</td><td>Full Screen Toggle</td></tr>\n",i+="  <tr><th>Search and Replace</th><th>Description</th></tr>\n",i+="  <tr><td>Ctrl-F</td><td>Start searching</td></tr>\n",i+="  <tr><td>Ctrl-G</td><td>Find next</td></tr>\n",i+="  <tr><td>Shift-Ctrl-G</td><td>Find previous</td></tr>\n",i+="  <tr><td>Shift-Ctrl-F</td><td>Replace</td></tr>\n",i+="  <tr><td>Shift-Ctrl-R</td><td>Replace all</td></tr>\n",i+="  <tr><th>Misc Keys</th><th>Description</th></tr>\n",i+="  <tr><td>Ctrl-Q</td><td>Fold all code groups toggle.</td></tr>\n",i+="</table>\n",i+='<div align="right"></div>\n',codemirrorPopup(i),!0}function codemirrorPopup(t){void 0!=document.getElementById(t)&&(t=getText(t)),popUpDiv("",{id:"codemirrorpop",drag:1,notop:1,nobot:1,noborder:1,nobackground:1,bodystyle:"padding:0px;border:0px;background:none;"}),setText("codemirrorpop",t),centerObject("codemirrorpop",1)}function tinymceInitialize(){{var t="bold,italic,underline,|,forecolor,backcolor,|,justifyleft,justifycenter,justifyright,|,bullist,numlist,outdent,indent,|,charmap,image,media,link,unlink,formatselect,code,fullscreen,fontsizeselect",e="",o="";tinyMCE.init({mode:"none",theme:"advanced",plugins:"table,advhr,inlinepopups,contextmenu,media,paste,fullscreen,visualchars,nonbreaking,xhtmlxtras,template,advlist,advimage",submit_patch:!1,paste_auto_cleanup_on_paste:!0,paste_text_replacements:[[/\u2026/g,"..."],[/[\x93\x94\u201c\u201d]/g,'"'],[/[\x60\x91\x92\u2018\u2019]/g,"'"],[/.*((https?|ssh|ftp|file):\/\/\S+).*/gi,'<a href="$1">$1</a>'],[/.*((https?|ssh|ftp|file):\/\/\S+((\.)bmp|gif|jpe?g|png|psd|tif?f)).*/gi,'<img src="$1" alt="image" />']],theme_advanced_buttons1:t,theme_advanced_buttons2:e,theme_advanced_buttons3:o,theme_advanced_buttons4:"",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_resizing:!0})}}function fullScreenToggle(t){var e=getObject(t);if(void 0==e)return!1;var o=e.getAttribute("fullscreen");if(void 0==o||0==o){var i=getWidthHeight(e);e.setAttribute("fullscreen",1),e.setAttribute("width_ori",i[0]),e.setAttribute("height_ori",i[1]),e.style.width=document.body.clientWidth+"px",e.style.height=document.body.clientHeight+"px"}else e.setAttribute("fullscreen",0),e.style.width=e.getAttribute("width_ori")+"px",e.style.height=e.getAttribute("height_ori")+"px"}function floatDiv(t,e){var o=getObject(t),i=0;if(void 0!=o.parentNode&&parseInt(o.parentNode.scrollTop)>0)i=parseInt(o.parentNode.scrollTop);else if(void 0!=document.documentElement&&parseInt(document.documentElement.scrollTop)>0)i=parseInt(document.documentElement.scrollTop);
else{if(!(void 0!=document.body&&parseInt(document.body.scrollTop)>0))return!1;i=parseInt(document.body.scrollTop)}var r=parseInt(e),a=Math.round(i+r);o.style.top=a+"px",setTimeout("floatDiv('"+t+"','"+e+"')",250)}function addDragToTextarea(t){var e=document.getElementById(t),o=(Math.round(e.offsetWidth+10),e.id+"_dragarea"),i=(e.id+"_dragcheckbox",findPosX(e)),r=findPosY(e),a=Math.round(i+e.offsetWidth-6),n=Math.round(r+e.offsetHeight-12),s='<span parentid="'+t+'" textareadrag="1" id="'+o+'" style="position:absolute;left:'+a+"px;top:"+n+'px;cursor:crosshair;color:#7F9DB9;font-size:13pt;font-family:times;" title="Drag to adjust size">&#9688;</span>',d=getParent(e);d.insertAdjacentHTML("beforeEnd",s);var l=document.getElementById(o);Drag.init(l),l.onDrag=function(t,e){var o=this.getAttribute("parentid"),a=document.getElementById(o),n=Math.round(t-i+6),s=Math.round(e-r+12);n>0&&(a.style.width=n+"px"),s>0&&(a.style.height=s+"px");for(var d=this.id,l=GetElementsByAttribute("span","textareadrag","1"),u=0;u<l.length;u++)if(l[u].id!=d){var c=l[u].getAttribute("parentid");if(void 0!=c){var v=document.getElementById(c),h=findPosX(v),m=findPosY(v),g=Math.round(h+v.offsetWidth-6),p=Math.round(m+v.offsetHeight-12);l[u].lastMouseX=g,l[u].lastMouseY=p,l[u].style.left=g+"px",l[u].style.top=p+"px"}}}}function storeCaret(t){"undefined"!=typeof t.createTextRange&&(t.caretPos=document.selection.createRange().duplicate())}function replaceText(t,e){if("undefined"!=typeof e.caretPos&&e.createTextRange){var o=e.caretPos;o.text=" "==o.text.charAt(o.text.length-1)?t+" ":t,o.select()}else if("undefined"!=typeof e.selectionStart){var i=e.value.substr(0,e.selectionStart),r=e.value.substr(e.selectionEnd),a=e.scrollTop;e.value=i+t+r,e.setSelectionRange&&(e.focus(),e.setSelectionRange(i.length+t.length,i.length+t.length)),e.scrollTop=a}else e.value+=t,e.focus(e.value.length-1)}function surroundText(t,e,o){if("undefined"!=typeof o.caretPos&&o.createTextRange){var i=o.caretPos;i.text=" "==i.text.charAt(i.text.length-1)?t+i.text+e+" ":t+i.text+e,i.select()}else if("undefined"!=typeof o.selectionStart){var r=o.value.substr(0,o.selectionStart),a=o.value.substr(o.selectionStart,o.selectionEnd-o.selectionStart),n=o.value.substr(o.selectionEnd),s=o.selectionStart,d=o.scrollTop;o.value=r+t+a+e+n,o.setSelectionRange&&(0==a.length?o.setSelectionRange(s+t.length,s+t.length):o.setSelectionRange(s,s+t.length+a.length+e.length),o.focus()),o.scrollTop=d}else o.value+=t+e,o.focus(o.value.length-1)}function isEmptyText(t){for(var e=t.value;e.length>0&&(" "==e.charAt(0)||"	"==e.charAt(0));)e=e.substring(1,e.length);for(;e.length>0&&(" "==e.charAt(e.length-1)||"	"==e.charAt(e.length-1));)e=e.substring(0,e.length-1);return""==e?!0:!1}function findPosX(t){var e=0;if(t.offsetParent)for(;t.offsetParent;)e+=t.offsetLeft,t=t.offsetParent;else t.x&&(e+=t.x);return e}function findPosY(t){var e=0;if(t.offsetParent)for(;t.offsetParent;)e+=t.offsetTop,t=t.offsetParent;else t.y&&(e+=t.y);return e}function slideShow(t,e,o){void 0==o&&(o=5);var i=Math.round(1e3*o);e=Math.round(e+0);var r=getObject(t);id="slideshow",clearTimeout(TimoutArray[id]);var a=r.getElementsByTagName("img");if(0==a.length)return alert("SlideShow Error: - No images found"),!1;e==a.length&&(e=0);for(var n=0;n<a.length;n++)n==e?addClass(a[n],"opaque"):removeClass(a[n],"opaque");e=Math.round(e+1),TimoutArray[id]=setTimeout("slideShow('"+t+"',"+e+","+o+")",i)}function stopWatch(t){clearTimeout(TimoutArray[t]);var e=getObject(t);e.onfocus=function(){this.setAttribute("hasfocus",1)},e.onblur=function(){this.setAttribute("hasfocus",0)};var o=e.getAttribute("hasfocus");if(void 0!=o&&1==o)return!1;var i=getText(t),r=0,a=0,n=0;if(i.length){var s=i.split(":");r=parseInt(s[0]),a=parseInt(s[1]),n=parseInt(s[2])}n++,60==n&&(n=0,a++),60==a&&(a=0,r++);var d=r+":"+a+":"+n;setText(t,d),TimoutArray[t]=setTimeout("stopWatch('"+t+"')",1e3)}function ajaxTimer(t){clearTimeout(TimoutArray[t]);var e=getObject(t);if(void 0!=e){var o=getAllAttributes(e);if(number=parseInt(void 0!=o.countdown?o.countdown:o.timer),number--,e.setAttribute("countdown",number),0>=number){var i=o.url.split("?"),r="";void 0!=i[1]&&(r=i[1]),ajaxGet(i[0],o.id,r),e.setAttribute("countdown",o.timer)}TimoutArray[t]=setTimeout("ajaxTimer('"+t+"')",1e3)}}function countDown(id){clearTimeout(TimoutArray[id]);var obj=getObject(id);if(void 0!=obj){var number=parseInt(getText(id));number--,setText(id,number);var cb=obj.getAttribute("callback");if(cb){var func=cb+"('"+id+"','"+number+"')";eval(func)}TimoutArray[id]=setTimeout("countDown('"+id+"')",1e3)}}function countDownDate(t,e,o,i,r,a,n){void 0==n&&(n="");var s=getObject(t);if(void 0!=s){theyear=e,themonth=o,theday=i,thehour=r,theminute=a;var d=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),l=new Date,u=l.getYear();1e3>u&&(u+=1900);var c=l.getMonth(),v=l.getDate(),h=l.getHours(),m=l.getMinutes(),g=l.getSeconds(),p=d[c]+" "+v+", "+u+" "+h+":"+m+":"+g;if(0==n.length)var b=Date.parse(p)+1e3*n*60*60;else var b=Date.parse(p);var f=d[o-1]+" "+i+", "+e+" "+r+":"+a,y=Date.parse(f)-6e4*l.getTimezoneOffset(),x=y-b,E=Math.floor(x/864e5*1),w=Math.floor(x%864e5/36e5*1),A=Math.floor(x%864e5%36e5/6e4*1),_=Math.floor(x%864e5%36e5%6e4/1e3*1);if(0>=E&&0>=w&&0>=A&&0>=_)return void(s.style.display="none");9>=w&&(w="0"+w),9>=A&&(A="0"+A),9>=_&&(_="0"+_);var M='<table cellspacing="0" class="w_countdown" cellspacing="2" border="0">\r\n';M+='<tr align="center"><th>'+E+"</th><th>"+w+"</th><th>"+A+"</th><th>"+_+"</th></tr>\r\n",M+='<tr align="center"><td>Day</td><td>Hour</td><td>Min</td><td>Sec</td></tr>\r\n',M+="</table>\r\n",setText(s,M),0==n.length?setTimeout("countDownDate('"+t+"',theyear,themonth,theday,thehour,theminute)",1e3):setTimeout("countDownDate('"+t+"',theyear,themonth,theday,thehour,theminute,tz)",1e3)}}function startClock(t,e){clearTimeout(TimoutArray[t]);var o=new Date,i=o.getHours(),r=o.getMinutes(),a=o.getSeconds(),n=" am";i>12&&(i-=12,n=" pm"),12==i&&(n=" pm");var s="";10>i&&(s+="0"),s+=i,s+=":",10>r&&(s+="0"),s+=r,s+=":",10>a&&(s+="0"),s+=a,s+=n,setText(t,s),e&&(TimoutArray[t]=setTimeout("startClock('"+t+"',"+e+")",1e3))}function startRaid(t,e){clearTimeout(TimoutArray[t]),setText(t,getText(e)),TimoutArray[t]=setTimeout("startRaid('"+t+"','"+e+"')",250)}function startSum(t,e){clearTimeout(TimoutArray[t]);for(var o=GetElementsByAttribute("*","id",e),i=0,r=0;r<o.length;r++){var a=getText(o[r]),n=Math.round(a);i+=n}setText(t,i),TimoutArray[t]=setTimeout("startSum('"+t+"','"+e+"')",250)}function doMath(id){var behavior=document.getElementById(id).getAttribute("data-behavior").toLowerCase(),re=new RegExp("^@([a-z]+)[(](.+)[)]$","igm"),str,res=re.exec(behavior);if(res&&res.length>0){for(var func=res[1].toLowerCase(),str=res[2].toLowerCase(),result=0,mre=new RegExp("([a-z0-9_]+)","igm");mres=mre.exec(str);)if(mres&&mres.length>0){var mname=mres[1],txt=getText(mres[1]),evalstr="str.replace(/"+mname+"/,'"+txt+"')";str=eval(evalstr)}try{str=eval(str),setText(id,str)}catch(err){setText(id,err)}}}function stopTimeout(t){clearTimeout(TimoutArray[t])}function checkMouseEnter(t,e){return t.contains&&e.fromElement?!t.contains(e.fromElement):e.relatedTarget?!containsDOM(t,e.relatedTarget):void 0}function checkMouseLeave(t,e){return t.contains&&void 0!=e.toElement?!t.contains(e.toElement):e.relatedTarget?!containsDOM(t,e.relatedTarget):void 0}function containsDOM(t,e){var o=!1;do{if(o=t==e)break;e=e.parentNode}while(null!=e);return o}function isOver(t,e){var o=getPos(t),i=getWidth(t),r=o.x+parseInt(i/2),a=getPos(e),n=getWidth(e),s=getHeight(e),d=a.x+n,s=a.y+s;return r>a.x&&d>r&&o.y>a.y&&o.y<s?!0:!1}function initDrop(tagname,tagatt,attval){void 0==tagname&&(tagname="div"),void 0==tagatt&&(tagatt="data-behavior"),void 0==attval&&(attval="dropdown");for(var navEls=GetElementsByAttribute(tagname,tagatt,attval),n=0;n<navEls.length;n++)navEls[n].onmouseout=function(e){if(void 0==e&&(e=fixE(e)),void 0!=e&&checkMouseLeave(this,e)){this.style.display="none";var onhide=this.getAttribute("onhide");onhide&&eval(onhide)}}}var MouseX=0,MouseY=0,cursor={x:0,y:0};document.onmousemove?document.onmousemove=mouseMove:document.addEventListener?(document.addEventListener("mousedown",mouseMove,!1),document.addEventListener("mouseup",mouseMove,!1),document.addEventListener("mousemove",mouseMove,!1)):document.attachEvent?(document.attachEvent("onmousedown",mouseMove),document.attachEvent("onmouseup",mouseMove),document.attachEvent("onmousemove",mouseMove)):document.captureEvents&&document.captureEvents(Event.MOUSEDOWN|Event.MOUSEMOVE|Event.MOUSEUP);var d=document,ns=-1!=navigator.appName.indexOf("Netscape"),changeState=new Array,changeValue=new Array,nicEditors=new Array,OnLoad="",schedulePageID="";sfHover=function(){for(var t=GetElementsByAttribute("ul","id","w_nav"),e=0;e<t.length;e++)for(var o=t[e].getElementsByTagName("LI"),i=0;i<o.length;i++)o[i].onmouseover=function(){this.className="sfhover"},o[i].onmouseout=function(){this.className=""}},addEvent(window,"load",sfHover);var calledStickyMenus=0;addEvent(window,"load",initBehaviors);var tinymceInitialized=0,TimoutArray=new Array,Drag={obj:null,init:function(t,e,o,i,r,a,n,s,d,l){t=getObject(t),t.onmousedown=Drag.start,t.hmode=n?!1:!0,t.vmode=s?!1:!0,t.root=e&&null!=e?e:t,t.hmode&&isNaN(parseInt(t.root.style.left))&&(t.root.style.left="0px"),t.vmode&&isNaN(parseInt(t.root.style.top))&&(t.root.style.top="0px"),!t.hmode&&isNaN(parseInt(t.root.style.right))&&(t.root.style.right="0px"),!t.vmode&&isNaN(parseInt(t.root.style.bottom))&&(t.root.style.bottom="0px");var u=parseInt(t.vmode?t.root.style.top:t.root.style.bottom),c=parseInt(t.hmode?t.root.style.left:t.root.style.right);t.startX=c,t.startY=u,t.minX="undefined"!=typeof o?o:null,t.minY="undefined"!=typeof r?r:null,t.maxX="undefined"!=typeof i?i:null,t.maxY="undefined"!=typeof a?a:null,t.xMapper=d?d:null,t.yMapper=l?l:null,t.onmouseover=function(){this.style.cursor="move"},t.root.onDragStart=new Function,t.root.onDragEnd=new Function,t.root.onDrag=new Function},start:function(t){var e=Drag.obj=this;t=Drag.fixE(t);var o=parseInt(e.vmode?e.root.style.top:e.root.style.bottom),i=parseInt(e.hmode?e.root.style.left:e.root.style.right);return e.root.onDragStart(i,o),Drag.obj.lastX=i,Drag.obj.lastY=o,e.lastMouseX=t.clientX,e.lastMouseY=t.clientY,e.hmode?(null!=e.minX&&(e.minMouseX=t.clientX-i+e.minX),null!=e.maxX&&(e.maxMouseX=e.minMouseX+e.maxX-e.minX)):(null!=e.minX&&(e.maxMouseX=-e.minX+t.clientX+i),null!=e.maxX&&(e.minMouseX=-e.maxX+t.clientX+i)),e.vmode?(null!=e.minY&&(e.minMouseY=t.clientY-o+e.minY),null!=e.maxY&&(e.maxMouseY=e.minMouseY+e.maxY-e.minY)):(null!=e.minY&&(e.maxMouseY=-e.minY+t.clientY+o),null!=e.maxY&&(e.minMouseY=-e.maxY+t.clientY+o)),document.onmousemove=Drag.drag,document.onmouseup=Drag.end,!1},drag:function(t){t=Drag.fixE(t);var e,o,i=Drag.obj,r=t.clientY,a=t.clientX,n=parseInt(i.vmode?i.root.style.top:i.root.style.bottom),s=parseInt(i.hmode?i.root.style.left:i.root.style.right);null!=i.minX&&(a=i.hmode?Math.max(a,i.minMouseX):Math.min(a,i.maxMouseX)),null!=i.maxX&&(a=i.hmode?Math.min(a,i.maxMouseX):Math.max(a,i.minMouseX)),null!=i.minY&&(r=i.vmode?Math.max(r,i.minMouseY):Math.min(r,i.maxMouseY)),null!=i.maxY&&(r=i.vmode?Math.min(r,i.maxMouseY):Math.max(r,i.minMouseY)),e=s+(a-i.lastMouseX)*(i.hmode?1:-1),o=n+(r-i.lastMouseY)*(i.vmode?1:-1),i.xMapper?e=i.xMapper(n):i.yMapper&&(o=i.yMapper(s)),Drag.obj.root.style[i.hmode?"left":"right"]=e+"px",Drag.obj.root.style[i.vmode?"top":"bottom"]=o+"px",Drag.obj.lastMouseX=a,Drag.obj.lastMouseY=r,Drag.obj.root.onDrag(e,o);for(var d=GetElementsByAttribute("*","_ondragover",".+"),l=0;l<d.length;l++)if(isOver(Drag.obj,d[l])){var u=d[l].getAttribute("_ondragover");d[l].setAttribute("_dragover",1);for(var c=new Object,v=0;v<d[l].attributes.length;v++){var h=d[l].attributes[v];c[h.name]=h.value}for(var m=new Object,v=0;v<Drag.obj.root.attributes.length;v++){var h=Drag.obj.root.attributes[v];m[h.name]=h.value}m.startX=Drag.obj.startX,m.startY=Drag.obj.startY,window[u](c,m)}else{var g=d[l].getAttribute("_dragover");if(void 0!=g&&1==g&&void 0!=d[l].getAttribute("_ondragout")){d[l].setAttribute("_dragover",0);for(var u=d[l].getAttribute("_ondragout"),c=new Object,v=0;v<d[l].attributes.length;v++){var h=d[l].attributes[v];c[h.name]=h.value}for(var m=new Object,v=0;v<Drag.obj.root.attributes.length;v++){var h=Drag.obj.root.attributes[v];m[h.name]=h.value}m.startX=Drag.obj.startX,m.startY=Drag.obj.startY,window[u](c,m)}}return!1},end:function(){document.onmousemove=null,document.onmouseup=null,Drag.obj.root.onDragEnd(parseInt(Drag.obj.root.style[Drag.obj.hmode?"left":"right"]),parseInt(Drag.obj.root.style[Drag.obj.vmode?"top":"bottom"]));var t=Drag.obj.getAttribute("data-ondragend");if(void 0==t&&(t=Drag.obj.getAttribute("_ondragend")),void 0!=t){for(var e=new Object,o=0;o<Drag.obj.attributes.length;o++){var i=Drag.obj.attributes[o];e[i.name]=i.value}e.drag_x=parseInt(Drag.obj.root.style[Drag.obj.hmode?"left":"right"]),e.drag_y=parseInt(Drag.obj.root.style[Drag.obj.vmode?"top":"bottom"]),window[t](e)}for(var r=GetElementsByAttribute("*","_ondrop",".+"),a=0;a<r.length;a++)if(isOver(Drag.obj,r[a])){for(var n=r[a].getAttribute("_ondrop"),s=new Object,o=0;o<r[a].attributes.length;o++){var i=r[a].attributes[o];s[i.name]=i.value}for(var e=new Object,o=0;o<Drag.obj.root.attributes.length;o++){var i=Drag.obj.root.attributes[o];e[i.name]=i.value}e.startX=Drag.obj.startX,e.startY=Drag.obj.startY,window[n](s,e)}Drag.obj=null},fixE:function(t){return"undefined"==typeof t&&(t=window.event),"undefined"==typeof t.layerX&&(t.layerX=t.offsetX),"undefined"==typeof t.layerY&&(t.layerY=t.offsetY),t}};