CodeMirror.tagRangeFinder=function(e,n){for(var r="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",i=r+"-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",t=new RegExp("^["+r+"]["+i+"]*"),a=e.getLine(n),u=!1,f=null,o=0;!u;){if(o=a.indexOf("<",o),-1==o)return;if(o+1<a.length&&"/"==a[o+1])o++;else if(a.substr(o+1).match(t)){var l=a.indexOf(">",o+1);if(-1==l){for(var s=n+1,d=!1,v=e.lineCount();v>s&&!d;){var F=e.getLine(s),g=F.indexOf(">");if(-1!=g){d=!0;var c=F.lastIndexOf("/",g);if(-1!=c&&g>c){var h=a.substr(c,g-c+1);if(!h.match(/\/\s*\>/))return s+1}}s++}u=!0}else{var x=a.lastIndexOf("/",l);if(-1==x)u=!0;else{var h=a.substr(x,l-x+1);h.match(/\/\s*\>/)||(u=!0)}}if(u){var p=a.substr(o+1);f=p.match(t),f?(f=f[0],-1!=a.indexOf("</"+f+">",o)&&(u=!1)):u=!1}u||o++}else o++}if(u)for(var C="(\\<\\/"+f+"\\>)|(\\<"+f+"\\>)|(\\<"+f+"s)|(\\<"+f+"$)",b=new RegExp(C,"g"),O="</"+f+">",L=1,s=n+1,v=e.lineCount();v>s;){a=e.getLine(s);var D=a.match(b);if(D)for(var m=0;m<D.length;m++)if(D[m]==O?L--:L++,!L)return s+1;s++}else;},CodeMirror.braceRangeFinder=function(e,n){var r=e.getLine(n),i=r.lastIndexOf("{");if(!(0>i||r.lastIndexOf("}")>i)){var t,a=e.getTokenAt({line:n,ch:i}).className,u=1,f=e.lineCount();e:for(var o=n+1;f>o;++o)for(var l=e.getLine(o),s=0;;){var d=l.indexOf("{",s),v=l.indexOf("}",s);if(0>d&&(d=l.length),0>v&&(v=l.length),s=Math.min(d,v),s==l.length)break;if(e.getTokenAt({line:o,ch:s+1}).className==a)if(s==d)++u;else if(!--u){t=o;break e}++s}if(null!=t&&t!=n+1)return t}},CodeMirror.indentRangeFinder=function(e,n){for(var r,i=e.getOption("tabSize"),t=e.getLineHandle(n).indentation(i),a=n+1,u=e.lineCount();u>a;++a){var f=e.getLineHandle(a);if(!/^\s*$/.test(f.text)){if(f.indentation(i)<=t)break;r=a}}return r?r+1:null},CodeMirror.newFoldFunction=function(e,n){function r(e,n){for(var r=0;r<t.length;++r){var i=e.lineInfo(t[r].start);if(i){if(i.line==n)return{pos:r,region:t[r]}}else t.splice(r--,1)}}function i(e,n){e.clearMarker(n.start);for(var r=0;r<n.hidden.length;++r)e.showLine(n.hidden[r])}var t=[];return null==n&&(n='<div style="position: absolute; left: 2px; color:#600">&#x25bc;</div>%N%'),function(a,u){a.operation(function(){var f=r(a,u);if(f)t.splice(f.pos,1),i(a,f.region);else{var o=e(a,u);if(null==o)return;for(var l=[],s=u+1;o>s;++s){var d=a.hideLine(s);d&&l.push(d)}var v=a.setMarker(u,n),F={start:v,hidden:l};a.onDeleteLine(v,function(){i(a,F)}),t.push(F)}})}};