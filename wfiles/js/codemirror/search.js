!function(){function e(){this.posFrom=this.posTo=this.query=null,this.marked=[]}function r(r){return r._searchState||(r._searchState=new e)}function o(e,r,o,n){e.openDialog?e.openDialog(r,n):n(prompt(o,""))}function n(e,r,o,n){e.openConfirm?e.openConfirm(r,n):confirm(o)&&n[0]()}function t(e){var r=e.match(/^\/(.*)\/$/);return r?new RegExp(r[1]):e}function i(e,n){var i=r(e);return i.query?c(e,n):(o(e,f,"Search for:",function(r){e.operation(function(){if(r&&!i.query){if(i.query=t(r),e.lineCount()<2e3)for(var o=e.getSearchCursor(r);o.findNext();)i.marked.push(e.markText(o.from(),o.to(),"CodeMirror-searching"));i.posFrom=i.posTo=e.getCursor(),c(e,n)}})}),void 0)}function c(e,o){e.operation(function(){var n=r(e),t=e.getSearchCursor(n.query,o?n.posFrom:n.posTo);(t.find(o)||(t=e.getSearchCursor(n.query,o?{line:e.lineCount()-1}:{line:0,ch:0}),t.find(o)))&&(e.setSelection(t.from(),t.to()),n.posFrom=t.from(),n.posTo=t.to())})}function a(e){e.operation(function(){var o=r(e);if(o.query){o.query=null;for(var n=0;n<o.marked.length;++n)o.marked[n].clear();o.marked.length=0}})}function u(e,r){o(e,s,"Replace:",function(i){i&&(i=t(i),o(e,p,"Replace with:",function(o){function t(){var r,o=u.from();((r=u.findNext())||(u=e.getSearchCursor(i),(r=u.findNext())&&(u.from().line!=o.line||u.from().ch!=o.ch)))&&(e.setSelection(u.from(),u.to()),n(e,l,"Replace?",[function(){c(r)},t]))}function c(e){u.replace("string"==typeof i?o:o.replace(/\$(\d)/,function(r,o){return e[o]})),t()}if(r)e.operation(function(){for(var r=e.getSearchCursor(i);r.findNext();)if("string"!=typeof i){var n=e.getRange(r.from(),r.to()).match(i);r.replace(o.replace(/\$(\d)/,function(e,r){return n[r]}))}else r.replace(o)});else{a(e);var u=e.getSearchCursor(i,e.getCursor());t()}}))})}var f='Search: <input type="text" style="width: 10em"> <span style="color: #888">(Use /re/ syntax for regexp search)</span>',s='Replace: <input type="text" style="width: 10em"> <span style="color: #888">(Use /re/ syntax for regexp search)</span>',p='With: <input type="text" style="width: 10em">',l="Replace? <button>Yes</button> <button>No</button> <button>Stop</button>";CodeMirror.commands.find=function(e){a(e),i(e)},CodeMirror.commands.findNext=i,CodeMirror.commands.findPrev=function(e){i(e,!0)},CodeMirror.commands.clearSearch=a,CodeMirror.commands.replace=u,CodeMirror.commands.replaceAll=function(e){u(e,!0)}}();